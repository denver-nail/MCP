import { NormalizedAudit } from "../types/customAudit.js";
import { RenderOptions } from "../types/render.js";
import { renderMarkdown } from "./markdown.js";

const desc: RenderOptions["desc"] = {
  severityLevels: {
    info: "信息",
    low: "低危",
    moderate: "中危",
    high: "高危",
    critical: "严重",
  },
};
/**
 * 讲auditResult渲染为markdown格式的字符串
 * @param {object} auditResult 规范化的审计结果
 * @param {object} packageJson 包的package.json内容
 */
export async function render(auditResult: NormalizedAudit, packageJson: any) {
  const data: RenderOptions = {
    audit: auditResult,
    desc,
    packageJson,
  };
  return await renderMarkdown(data);
}
