import { Vulnerability } from "./npmAudit.js";

// 单条规范化后的包信息类型
export interface NormalizedPackage {
  name: string;
  severity: Vulnerability["severity"]; // "info" | "low" | "moderate" | "high" | "critical"
  problems: {
    source?: number;
    name?: string;
    severity?: string;
    dependency?: string;
    title?: string;
  }[];
  effects: string[];
  range: string;
  nodes: string[];
  fixAvailable: Vulnerability["fixAvailable"];
  depChain: string[][];
}
// 审计结果分桶类型（按严重级别）
export type Severity = Vulnerability["severity"]; // 联合字面量类型
export type AuditBuckets = Record<Severity, NormalizedPackage[]>; // { info:[], low:[], ... }

export interface NormalizedAudit {
  vulnerabilities: AuditBuckets;
  summary?: {
    total: number;
    critical: number;
    high: number;
    moderate: number;
    low: number;
  };
}
