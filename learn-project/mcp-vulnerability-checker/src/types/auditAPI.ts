// 顶层审计报告类型（包含修复建议的格式）
export interface NpmAuditReport {
  /** 建议的修复操作列表 */
  actions: AuditAction[];

  /** 漏洞详情集合（key 为漏洞ID） */
  advisories: Record<string, Advisory>;

  /** 已静音的漏洞（通常为空数组） */
  muted: any[];

  /** 审计元数据（统计信息） */
  metadata: AuditMetadata;
}

// 修复操作类型
interface AuditAction {
  /** 是否为重大版本升级 */
  isMajor: boolean;

  /** 操作类型（通常为 "install" 表示需要安装新版本） */
  action: "install" | string;

  /** 该操作能解决的漏洞列表 */
  resolves: Array<{
    /** 漏洞ID */
    id: number;
    /** 受影响的包路径 */
    path: string;
    /** 是否为开发依赖 */
    dev: boolean;
    /** 是否为可选依赖 */
    optional: boolean;
    /** 是否为捆绑依赖 */
    bundled: boolean;
  }>;

  /** 涉及的模块名称 */
  module: string;

  /** 目标版本（需要升级到的版本） */
  target: string;
}

// 漏洞详情类型
interface Advisory {
  /** 漏洞发现信息 */
  findings: Array<{
    /** 受影响的版本 */
    version: string;
    /** 受影响的路径 */
    paths: string[];
  }>;

  /** 发现者信息（可能为null） */
  found_by: any;

  /** 删除时间（可能为null） */
  deleted: any;

  /** 参考链接（换行分隔） */
  references: string;

  /** 创建时间（ISO格式） */
  created: string;

  /** 漏洞ID */
  id: number;

  /** npm官方漏洞ID（可能为null） */
  npm_advisory_id: any;

  /** 漏洞概述 */
  overview: string;

  /** 报告者信息（可能为null） */
  reported_by: any;

  /** 漏洞标题 */
  title: string;

  /** 元数据（可能为null） */
  metadata: any;

  /** CVE编号列表 */
  cves: string[];

  /** 访问权限（通常为"public"） */
  access: string;

  /** 漏洞严重程度 */
  severity: "info" | "low" | "moderate" | "high" | "critical";

  /** 受影响的模块名称 */
  module_name: string;

  /** 存在漏洞的版本范围 */
  vulnerable_versions: string;

  /** GitHub漏洞ID */
  github_advisory_id: string;

  /** 修复建议 */
  recommendation: string;

  /** 已修复的版本范围 */
  patched_versions: string;

  /** 更新时间（ISO格式） */
  updated: string;

  /** CVSS评分信息 */
  cvss: {
    /** 评分（0-10） */
    score: number;
    /** CVSS向量字符串 */
    vectorString: string;
  };

  /** CWE编号列表 */
  cwe: string[];

  /** 漏洞详情URL */
  url: string;
}

// 审计元数据类型
interface AuditMetadata {
  /** 漏洞统计 */
  vulnerabilities: {
    info: number;
    low: number;
    moderate: number;
    high: number;
    critical: number;
  };

  /** 生产依赖数量 */
  dependencies: number;

  /** 开发依赖数量 */
  devDependencies: number;

  /** 可选依赖数量 */
  optionalDependencies: number;

  /** 总依赖数量 */
  totalDependencies: number;
}
