import { runCommand } from "../common/utils.js";
import { NpmAuditReport } from "../types/npmAudit.js";

export async function npmAudit(workDir: string): Promise<NpmAuditReport> {
  // 构造npm命令，执行npm audit命令
  const cmd = `npm audit --json`;
  const result = await runCommand(cmd, workDir);
  return JSON.parse(result);
}
